'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _feature = require('../models/feature');

var _feature2 = _interopRequireDefault(_feature);

var _gherkin = require('gherkin');

var _gherkin2 = _interopRequireDefault(_gherkin);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var gherkinCompiler = new _gherkin2.default.Compiler();
var gherkinParser = new _gherkin2.default.Parser();

var Parser = function () {
  function Parser() {
    (0, _classCallCheck3.default)(this, Parser);
  }

  (0, _createClass3.default)(Parser, null, [{
    key: 'parse',
    value: function parse(_ref) {
      var scenarioFilter = _ref.scenarioFilter,
          source = _ref.source,
          uri = _ref.uri;

      var gherkinDocument = void 0;
      try {
        gherkinDocument = gherkinParser.parse(source);
      } catch (error) {
        error.message += '\npath: ' + uri;
        throw error;
      }

      if (gherkinDocument.feature) {
        return new _feature2.default({
          gherkinData: gherkinDocument.feature,
          gherkinPickles: gherkinCompiler.compile(gherkinDocument, uri),
          scenarioFilter: scenarioFilter,
          uri: uri
        });
      }
    }
  }]);
  return Parser;
}();

exports.default = Parser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jbGkvZmVhdHVyZV9wYXJzZXIuanMiXSwibmFtZXMiOlsiZ2hlcmtpbkNvbXBpbGVyIiwiQ29tcGlsZXIiLCJnaGVya2luUGFyc2VyIiwiUGFyc2VyIiwic2NlbmFyaW9GaWx0ZXIiLCJzb3VyY2UiLCJ1cmkiLCJnaGVya2luRG9jdW1lbnQiLCJwYXJzZSIsImVycm9yIiwibWVzc2FnZSIsImZlYXR1cmUiLCJnaGVya2luRGF0YSIsImdoZXJraW5QaWNrbGVzIiwiY29tcGlsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQSxrQkFBa0IsSUFBSSxrQkFBUUMsUUFBWixFQUF4QjtBQUNBLElBQU1DLGdCQUFnQixJQUFJLGtCQUFRQyxNQUFaLEVBQXRCOztJQUVxQkEsTTs7Ozs7OztnQ0FDMkI7QUFBQSxVQUEvQkMsY0FBK0IsUUFBL0JBLGNBQStCO0FBQUEsVUFBZkMsTUFBZSxRQUFmQSxNQUFlO0FBQUEsVUFBUEMsR0FBTyxRQUFQQSxHQUFPOztBQUM1QyxVQUFJQyx3QkFBSjtBQUNBLFVBQUk7QUFDRkEsMEJBQWtCTCxjQUFjTSxLQUFkLENBQW9CSCxNQUFwQixDQUFsQjtBQUNELE9BRkQsQ0FFRSxPQUFPSSxLQUFQLEVBQWM7QUFDZEEsY0FBTUMsT0FBTixJQUFpQixhQUFhSixHQUE5QjtBQUNBLGNBQU1HLEtBQU47QUFDRDs7QUFFRCxVQUFJRixnQkFBZ0JJLE9BQXBCLEVBQTZCO0FBQzNCLGVBQU8sc0JBQVk7QUFDakJDLHVCQUFhTCxnQkFBZ0JJLE9BRFo7QUFFakJFLDBCQUFnQmIsZ0JBQWdCYyxPQUFoQixDQUF3QlAsZUFBeEIsRUFBeUNELEdBQXpDLENBRkM7QUFHakJGLHdDQUhpQjtBQUlqQkU7QUFKaUIsU0FBWixDQUFQO0FBTUQ7QUFDRjs7Ozs7a0JBbEJrQkgsTSIsImZpbGUiOiJmZWF0dXJlX3BhcnNlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBGZWF0dXJlIGZyb20gJy4uL21vZGVscy9mZWF0dXJlJ1xuaW1wb3J0IEdoZXJraW4gZnJvbSAnZ2hlcmtpbidcblxuY29uc3QgZ2hlcmtpbkNvbXBpbGVyID0gbmV3IEdoZXJraW4uQ29tcGlsZXIoKVxuY29uc3QgZ2hlcmtpblBhcnNlciA9IG5ldyBHaGVya2luLlBhcnNlcigpXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhcnNlciB7XG4gIHN0YXRpYyBwYXJzZSh7IHNjZW5hcmlvRmlsdGVyLCBzb3VyY2UsIHVyaSB9KSB7XG4gICAgbGV0IGdoZXJraW5Eb2N1bWVudFxuICAgIHRyeSB7XG4gICAgICBnaGVya2luRG9jdW1lbnQgPSBnaGVya2luUGFyc2VyLnBhcnNlKHNvdXJjZSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3IubWVzc2FnZSArPSAnXFxucGF0aDogJyArIHVyaVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICBpZiAoZ2hlcmtpbkRvY3VtZW50LmZlYXR1cmUpIHtcbiAgICAgIHJldHVybiBuZXcgRmVhdHVyZSh7XG4gICAgICAgIGdoZXJraW5EYXRhOiBnaGVya2luRG9jdW1lbnQuZmVhdHVyZSxcbiAgICAgICAgZ2hlcmtpblBpY2tsZXM6IGdoZXJraW5Db21waWxlci5jb21waWxlKGdoZXJraW5Eb2N1bWVudCwgdXJpKSxcbiAgICAgICAgc2NlbmFyaW9GaWx0ZXIsXG4gICAgICAgIHVyaVxuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cbiJdfQ==