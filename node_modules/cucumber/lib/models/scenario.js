'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _gherkin = require('gherkin');

var _gherkin2 = _interopRequireDefault(_gherkin);

var _step = require('./step');

var _step2 = _interopRequireDefault(_step);

var _tag = require('./tag');

var _tag2 = _interopRequireDefault(_tag);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var Scenario = function Scenario(options) {
  var _this = this;

  (0, _classCallCheck3.default)(this, Scenario);
  var backgroundStepLines = options.backgroundStepLines,
      feature = options.feature,
      gherkinData = options.gherkinData,
      language = options.language,
      lineToDescriptionMapping = options.lineToDescriptionMapping,
      stepLineToKeywordMapping = options.stepLineToKeywordMapping;


  this.feature = feature;
  this.keyword = _lodash2.default.first(_gherkin2.default.DIALECTS[language].scenario);
  this.lines = _lodash2.default.map(gherkinData.locations, 'line');
  this.name = gherkinData.name;
  this.tags = _lodash2.default.map(gherkinData.tags, _tag2.default.build);
  this.uri = feature.uri;

  this.line = _lodash2.default.first(this.lines);
  this.description = _lodash2.default.chain(this.lines).map(function (line) {
    return lineToDescriptionMapping[line];
  }).compact().first().value();

  var previousStep = void 0;
  this.steps = _lodash2.default.map(gherkinData.steps, function (gherkinStepData) {
    var step = new _step2.default({
      backgroundLines: backgroundStepLines,
      gherkinData: gherkinStepData,
      language: language,
      lineToKeywordMapping: stepLineToKeywordMapping,
      previousStep: previousStep,
      scenario: _this
    });
    previousStep = step;
    return step;
  });
};

exports.default = Scenario;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb2RlbHMvc2NlbmFyaW8uanMiXSwibmFtZXMiOlsiU2NlbmFyaW8iLCJvcHRpb25zIiwiYmFja2dyb3VuZFN0ZXBMaW5lcyIsImZlYXR1cmUiLCJnaGVya2luRGF0YSIsImxhbmd1YWdlIiwibGluZVRvRGVzY3JpcHRpb25NYXBwaW5nIiwic3RlcExpbmVUb0tleXdvcmRNYXBwaW5nIiwia2V5d29yZCIsImZpcnN0IiwiRElBTEVDVFMiLCJzY2VuYXJpbyIsImxpbmVzIiwibWFwIiwibG9jYXRpb25zIiwibmFtZSIsInRhZ3MiLCJidWlsZCIsInVyaSIsImxpbmUiLCJkZXNjcmlwdGlvbiIsImNoYWluIiwiY29tcGFjdCIsInZhbHVlIiwicHJldmlvdXNTdGVwIiwic3RlcHMiLCJzdGVwIiwiYmFja2dyb3VuZExpbmVzIiwiZ2hlcmtpblN0ZXBEYXRhIiwibGluZVRvS2V5d29yZE1hcHBpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0lBRXFCQSxRLEdBQ25CLGtCQUFZQyxPQUFaLEVBQXFCO0FBQUE7O0FBQUE7QUFBQSxNQUVqQkMsbUJBRmlCLEdBUWZELE9BUmUsQ0FFakJDLG1CQUZpQjtBQUFBLE1BR2pCQyxPQUhpQixHQVFmRixPQVJlLENBR2pCRSxPQUhpQjtBQUFBLE1BSWpCQyxXQUppQixHQVFmSCxPQVJlLENBSWpCRyxXQUppQjtBQUFBLE1BS2pCQyxRQUxpQixHQVFmSixPQVJlLENBS2pCSSxRQUxpQjtBQUFBLE1BTWpCQyx3QkFOaUIsR0FRZkwsT0FSZSxDQU1qQkssd0JBTmlCO0FBQUEsTUFPakJDLHdCQVBpQixHQVFmTixPQVJlLENBT2pCTSx3QkFQaUI7OztBQVVuQixPQUFLSixPQUFMLEdBQWVBLE9BQWY7QUFDQSxPQUFLSyxPQUFMLEdBQWUsaUJBQUVDLEtBQUYsQ0FBUSxrQkFBUUMsUUFBUixDQUFpQkwsUUFBakIsRUFBMkJNLFFBQW5DLENBQWY7QUFDQSxPQUFLQyxLQUFMLEdBQWEsaUJBQUVDLEdBQUYsQ0FBTVQsWUFBWVUsU0FBbEIsRUFBNkIsTUFBN0IsQ0FBYjtBQUNBLE9BQUtDLElBQUwsR0FBWVgsWUFBWVcsSUFBeEI7QUFDQSxPQUFLQyxJQUFMLEdBQVksaUJBQUVILEdBQUYsQ0FBTVQsWUFBWVksSUFBbEIsRUFBd0IsY0FBSUMsS0FBNUIsQ0FBWjtBQUNBLE9BQUtDLEdBQUwsR0FBV2YsUUFBUWUsR0FBbkI7O0FBRUEsT0FBS0MsSUFBTCxHQUFZLGlCQUFFVixLQUFGLENBQVEsS0FBS0csS0FBYixDQUFaO0FBQ0EsT0FBS1EsV0FBTCxHQUFtQixpQkFBRUMsS0FBRixDQUFRLEtBQUtULEtBQWIsRUFDaEJDLEdBRGdCLENBQ1o7QUFBQSxXQUFRUCx5QkFBeUJhLElBQXpCLENBQVI7QUFBQSxHQURZLEVBRWhCRyxPQUZnQixHQUdoQmIsS0FIZ0IsR0FJaEJjLEtBSmdCLEVBQW5COztBQU1BLE1BQUlDLHFCQUFKO0FBQ0EsT0FBS0MsS0FBTCxHQUFhLGlCQUFFWixHQUFGLENBQU1ULFlBQVlxQixLQUFsQixFQUF5QiwyQkFBbUI7QUFDdkQsUUFBTUMsT0FBTyxtQkFBUztBQUNwQkMsdUJBQWlCekIsbUJBREc7QUFFcEJFLG1CQUFhd0IsZUFGTztBQUdwQnZCLHdCQUhvQjtBQUlwQndCLDRCQUFzQnRCLHdCQUpGO0FBS3BCaUIsZ0NBTG9CO0FBTXBCYjtBQU5vQixLQUFULENBQWI7QUFRQWEsbUJBQWVFLElBQWY7QUFDQSxXQUFPQSxJQUFQO0FBQ0QsR0FYWSxDQUFiO0FBWUQsQzs7a0JBdENrQjFCLFEiLCJmaWxlIjoic2NlbmFyaW8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgR2hlcmtpbiBmcm9tICdnaGVya2luJ1xuaW1wb3J0IFN0ZXAgZnJvbSAnLi9zdGVwJ1xuaW1wb3J0IFRhZyBmcm9tICcuL3RhZydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NlbmFyaW8ge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgY29uc3Qge1xuICAgICAgYmFja2dyb3VuZFN0ZXBMaW5lcyxcbiAgICAgIGZlYXR1cmUsXG4gICAgICBnaGVya2luRGF0YSxcbiAgICAgIGxhbmd1YWdlLFxuICAgICAgbGluZVRvRGVzY3JpcHRpb25NYXBwaW5nLFxuICAgICAgc3RlcExpbmVUb0tleXdvcmRNYXBwaW5nXG4gICAgfSA9IG9wdGlvbnNcblxuICAgIHRoaXMuZmVhdHVyZSA9IGZlYXR1cmVcbiAgICB0aGlzLmtleXdvcmQgPSBfLmZpcnN0KEdoZXJraW4uRElBTEVDVFNbbGFuZ3VhZ2VdLnNjZW5hcmlvKVxuICAgIHRoaXMubGluZXMgPSBfLm1hcChnaGVya2luRGF0YS5sb2NhdGlvbnMsICdsaW5lJylcbiAgICB0aGlzLm5hbWUgPSBnaGVya2luRGF0YS5uYW1lXG4gICAgdGhpcy50YWdzID0gXy5tYXAoZ2hlcmtpbkRhdGEudGFncywgVGFnLmJ1aWxkKVxuICAgIHRoaXMudXJpID0gZmVhdHVyZS51cmlcblxuICAgIHRoaXMubGluZSA9IF8uZmlyc3QodGhpcy5saW5lcylcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gXy5jaGFpbih0aGlzLmxpbmVzKVxuICAgICAgLm1hcChsaW5lID0+IGxpbmVUb0Rlc2NyaXB0aW9uTWFwcGluZ1tsaW5lXSlcbiAgICAgIC5jb21wYWN0KClcbiAgICAgIC5maXJzdCgpXG4gICAgICAudmFsdWUoKVxuXG4gICAgbGV0IHByZXZpb3VzU3RlcFxuICAgIHRoaXMuc3RlcHMgPSBfLm1hcChnaGVya2luRGF0YS5zdGVwcywgZ2hlcmtpblN0ZXBEYXRhID0+IHtcbiAgICAgIGNvbnN0IHN0ZXAgPSBuZXcgU3RlcCh7XG4gICAgICAgIGJhY2tncm91bmRMaW5lczogYmFja2dyb3VuZFN0ZXBMaW5lcyxcbiAgICAgICAgZ2hlcmtpbkRhdGE6IGdoZXJraW5TdGVwRGF0YSxcbiAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICAgIGxpbmVUb0tleXdvcmRNYXBwaW5nOiBzdGVwTGluZVRvS2V5d29yZE1hcHBpbmcsXG4gICAgICAgIHByZXZpb3VzU3RlcCxcbiAgICAgICAgc2NlbmFyaW86IHRoaXNcbiAgICAgIH0pXG4gICAgICBwcmV2aW91c1N0ZXAgPSBzdGVwXG4gICAgICByZXR1cm4gc3RlcFxuICAgIH0pXG4gIH1cbn1cbiJdfQ==